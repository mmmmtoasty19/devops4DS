---
title: "Penguins EDA"
format: 
    html:
        code-fold: true
        embed-resources: true
---


```{r}

con <- DBI::dbConnect(duckdb::duckdb())
DBI::dbExecute(con, "INSTALL httpfs")
DBI::dbExecute(con, "LOAD httpfs")
DBI::dbExecute(con, "CREATE VIEW penguin AS SELECT * FROM read_parquet('s3://do4ds-lab-kyle/data/penguins.parquet')")

df <- dplyr::tbl(con, "penguin") |> dplyr::collect()

```


```{r}
df |> 
  dplyr::group_by(species, sex) |> 
  dplyr::summarise(
    dplyr::across(
      dplyr::where(is.numeric), 
      \(x) mean(x, na.rm = TRUE)
      )
    ) |> 
  knitr::kable()
```

## Penguin Size vs Mass by Species

```{r}
df |> 
  ggplot2::ggplot(ggplot2::aes(x = bill_length_mm, y = body_mass_g, color = species)) +
  ggplot2::geom_point() + 
  ggplot2::geom_smooth(method = "lm")
```


```{r}
DBI::dbDisconnect(con)
```